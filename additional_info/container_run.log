fakhriakmalh@Fakhris-MacBook-Air ~ % docker run -d fithub-py:1.3.0 sleep infinity
38f36e4da19ebd1b38f4e4a724ad78e0b68635eab364604e8d1e7f77f8366171
fakhriakmalh@Fakhris-MacBook-Air ~ % docker ps
CONTAINER ID   IMAGE             COMMAND            CREATED         STATUS         PORTS     NAMES
38f36e4da19e   fithub-py:1.3.0   "sleep infinity"   5 seconds ago   Up 3 seconds             romantic_haslett
fakhriakmalh@Fakhris-MacBook-Air ~ % docker exec -it 38f36e4da19e /bin/bash
root@38f36e4da19e:/app# ls
Dockerfile  Dockerfile-python  dataset  myenv  output.csv  processing.py  query.sql  requirements.txt
root@38f36e4da19e:/app# python3 processing.py
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/07/22 07:56:56 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Row(id=2, lead_id='Bbd3c7b2448041dc5339b23878cacd79', source_category='Online', created_at=datetime.datetime(2024, 5, 10, 11, 16, 27, 919000), preferred_location='Adityawarman', timezone_location='Asia/jakarta', current_status='Warm')
Row(transaction_id='62afd56341d234457415c97c9c866aa9', transaction_status='Paid', transaction_at=datetime.datetime(2024, 5, 2, 11, 19, 27, 651000), transaction_location='Mampang', timezone_transaction='Asia/jakarta', transaction_type='New')
Row(referral_at=datetime.datetime(2024, 5, 13, 10, 30, 51), referral_id='962788593e04380982da789b978dcad6', referee_id='4f0595d6c1e4da52bcd4af627e89f0f8', referee_name='422005a39b6749f8a7f704fc62e2890d', referee_phone='6868015ee627081d0ec2e58f8c08ed45', referral_reward_id='Null', referral_source='Draft Transaction', referrer_id='Cadba628952bde1670ac4c0792afc28a', transaction_id='3976319532e4346ed060a48ed94f77c7', updated_at=datetime.datetime(2024, 5, 13, 10, 30, 51), user_referral_status_id=1)
Row(id=14, user_id='93128ee70cc2e95bc632eb73f472213d', name='Ec55b0c6b4cf5e7e08ddcfbc0465b796', phone_number='6e31e9665f3727cedcbdf8c8d9e7fb23', homeclub='Adityawarman', timezone_homeclub='Asia/jakarta', membership_expired_date=datetime.date(2024, 3, 31), is_deleted=False)
Row(id=3, description='Tidak Berhasil', created_at=datetime.datetime(2024, 3, 8, 17, 7, 10))
Row(id=9, user_referral_id='94c879700ebaca070e85035b8a28fc2c', source_transaction_id='Null', created_at=datetime.datetime(2024, 5, 24, 17, 43, 26), is_reward_granted=False)
Row(id=3, reward_value='15 Days', created_at=datetime.datetime(2024, 3, 13, 9, 45, 15), reward_type=1)
24/07/22 07:57:06 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
+-------------------+--------------------+-----------------+------------------------+-------------------+--------------------+--------------------+---------------------+-------------------+--------------------+--------------------+--------------------+---------------+---------------+--------------------+------------------+--------------------+--------------------+----------------+-------------------+-------------------+-----------------------+
|referral_details_id|         referral_id|  referral_source|referral_source_category|        referral_at|         referrer_id|       referrer_name|referrer_phone_number|  referrer_homeclub|          referee_id|        referee_name|       referee_phone|referral_status|num_reward_days|      transaction_id|transaction_status|      transaction_at|transaction_location|transaction_type|         updated_at|  reward_granted_at|is_business_logic_valid|
+-------------------+--------------------+-----------------+------------------------+-------------------+--------------------+--------------------+---------------------+-------------------+--------------------+--------------------+--------------------+---------------+---------------+--------------------+------------------+--------------------+--------------------+----------------+-------------------+-------------------+-----------------------+
|               NULL|274ef52f2f70dbb3a...|Draft Transaction|                 Offline|2024-05-13 16:47:45|192befbbd8b97260e...|2eb4b6e1ee9574c9e...| 9ed91c0255c3d7f46...|              Pluit|0c20fa7d62f00a047...|3312d5d62e3ce32c3...|0973f2b609f2d8e82...|       Menunggu|           NULL|0fc3fb996325ee9e2...|              NULL|                NULL|                NULL|            NULL|2024-05-13 16:47:45|               NULL|                      1|
|               NULL|D0c11363fa2754323...|     User Sign Up|                  Online|2024-04-30 20:54:15|4acfa96cb521b6963...|A2d59a13f5f24ae69...| De389f61ac5c8c7ec...|             Blok M|C8c0461f1332b2580...|C315681adbaee59c3...|C72ff35974713260b...| Tidak Berhasil|           NULL|Da0071e2bb7794ac1...|              NULL|                NULL|                NULL|            NULL|2024-05-23 12:33:24|               NULL|                      1|
|               NULL|E3a55877243e31f61...|Draft Transaction|                 Offline|2024-05-13 11:11:39|8575e4f470c06e133...|003609f9b658dc89c...| Be0692cdaa467a4d9...|Arteri Pondok Indah|A0a8f598a579d59b0...|C7227da53187dac12...|9c29e785a9fadbb9c...|       Menunggu|           NULL|73f8158ade927532c...|              NULL|                NULL|                NULL|            NULL|2024-05-13 11:11:39|               NULL|                      1|
|                 21|678d8990730250f80...|     User Sign Up|                  Online|2024-03-08 18:31:24|93128ee70cc2e95bc...|Ec55b0c6b4cf5e7e0...| 6e31e9665f3727ced...|       Adityawarman|C6fb4aa67eba0ed85...|Ad11a4f658fe00796...|Ce52ad7070f305b43...|       Menunggu|           NULL|7709d17eaec03665f...|              NULL|                NULL|                NULL|            NULL|2024-05-01 09:58:58|2024-03-08 18:33:50|                      1|
|                 15|A95d6a6cefee85033...|Draft Transaction|                 Offline|2024-05-21 16:47:11|Ac7437a85f72bcef2...|3bc4f73ee40575f76...| 488b1d38c3a3d84ab...|        Sunset Road|D0f7a95f117a5b084...|Aeed83f1695c48689...|7e5a9e249a06af8dc...|       Berhasil|        10 Days|0ad3f929bef2f8177...|              Paid|2024-05-21 16:47:...|        Adityawarman|             New|2024-05-21 16:49:45|2024-05-21 16:49:46|                      0|
|               NULL|30a0cdbe9f518b993...|             Lead|                  Online|2024-04-16 14:09:25|B755269324c62c3a6...|                NULL|                 NULL|               NULL|08b8ab0371b6a0cb7...|360701f01f7836349...|Ce52ad7070f305b43...|       Menunggu|           NULL|4c8cae052f19cea66...|              NULL|                NULL|                NULL|            NULL|2024-05-01 09:58:57|               NULL|                      1|
|               NULL|962788593e0438098...|Draft Transaction|                 Offline|2024-05-13 10:30:51|Cadba628952bde167...|2eb4b6e1ee9574c9e...| 6f1afb7c23074684e...|              Pluit|4f0595d6c1e4da52b...|422005a39b6749f8a...|6868015ee627081d0...|       Menunggu|           NULL|3976319532e4346ed...|              NULL|                NULL|                NULL|            NULL|2024-05-13 10:30:51|               NULL|                      1|
|               NULL|D452feec722a5cabc...|             Lead|                  Online|2024-03-20 14:48:49|Cbac8ed440d53d1c6...|                NULL|                 NULL|               NULL|08b8ab0371b6a0cb7...|360701f01f7836349...|Ce52ad7070f305b43...|       Menunggu|        10 Days|7709d17eaec03665f...|              NULL|                NULL|                NULL|            NULL|2024-05-01 09:58:57|               NULL|                      0|
|               NULL|D47843579ed8d4696...|Draft Transaction|                 Offline|2024-05-22 14:24:50|D0a0d9ca8dc4f4722...|49452c26f7b12cd57...| F495c5b0268d9896b...|             Benhil|109b6bf8d2664e5c4...|Feb4d885f99957d87...|E9d0dac01b424c1c8...|       Menunggu|           NULL|518f2f962f0046593...|              NULL|                NULL|                NULL|            NULL|2024-05-22 14:24:50|               NULL|                      1|
|                 30|9e9324e6fde29bb0d...|Draft Transaction|                 Offline|2024-05-14 13:17:03|F2de40c8394f4ea9a...|2eb4b6e1ee9574c9e...| D02b067e0f767dbb4...|              Pluit|D1b90f8e27b5ec0d3...|2e68f7f5c8854bd2c...|321b0102e766ef73b...|       Berhasil|        20 Days|E05121ea99fed4f4c...|              Paid|2024-05-14 13:17:...|        Adityawarman|             New|2024-05-14 13:17:34|2024-05-14 13:17:36|                      0|
+-------------------+--------------------+-----------------+------------------------+-------------------+--------------------+--------------------+---------------------+-------------------+--------------------+--------------------+--------------------+---------------+---------------+--------------------+------------------+--------------------+--------------------+----------------+-------------------+-------------------+-----------------------+