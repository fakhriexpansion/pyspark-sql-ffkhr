fakhriakmalh@Fakhris-MacBook-Air ~ % docker run -d fithub-py:1.3.0 sleep infinity
68906c930ea126389c780683466515bcd11cfa6d0b1f8423efbb367691004885
fakhriakmalh@Fakhris-MacBook-Air ~ % docker ps
CONTAINER ID   IMAGE             COMMAND            CREATED         STATUS         PORTS     NAMES
68906c930ea1   fithub-py:1.3.0   "sleep infinity"   4 seconds ago   Up 3 seconds             gifted_ptolemy
fakhriakmalh@Fakhris-MacBook-Air ~ % docker container exec -it 68906c930ea1 /bin/bash
root@68906c930ea1:/app# ls
Dockerfile  additional_info  faas-kubernetes-creds.json  output.csv     query.sql
README.md   dataset          myenv                       processing.py  requirements.txt
root@68906c930ea1:/app# python3 processing.py --upload_gcp 1 --bucket_name mxfaas-storage --sa_file faas-kubernetes-creds.json
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/07/25 16:00:25 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
finish drop null and duplicates
finish drop null and duplicates
finish drop null and duplicates
finish drop null and duplicates
finish drop null and duplicates
finish drop null and duplicates
finish drop null and duplicates
24/07/25 16:00:33 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
finish upload to GCS
+-------------------+--------------------+-----------------+------------------------+-------------------+--------------------+--------------------+---------------------+-----------------+--------------------+--------------------+--------------------+---------------+---------------+--------------------+------------------+--------------------+--------------------+----------------+-------------------+-----------------+-----------------------+
|referral_details_id|         referral_id|  referral_source|referral_source_category|        referral_at|         referrer_id|       referrer_name|referrer_phone_number|referrer_homeclub|          referee_id|        referee_name|       referee_phone|referral_status|num_reward_days|      transaction_id|transaction_status|      transaction_at|transaction_location|transaction_type|         updated_at|reward_granted_at|is_business_logic_valid|
+-------------------+--------------------+-----------------+------------------------+-------------------+--------------------+--------------------+---------------------+-----------------+--------------------+--------------------+--------------------+---------------+---------------+--------------------+------------------+--------------------+--------------------+----------------+-------------------+-----------------+-----------------------+
|               NULL|7a03e01e0c17b2322...|     User Sign Up|                  Online|2024-04-22 22:04:57|2c71c5d66c7e12a0b...|6380232145160dca7...| 87e6571bf783832ff...|           Benhil|8ef43a9189c084778...|8ef43a9189c084778...|Ce52ad7070f305b43...|       Berhasil|             15|4c8cae052f19cea66...|              NULL|                NULL|                NULL|            NULL|2024-04-30 09:42:30|             NULL|                  false|
|               NULL|61717d10675342854...|             Lead|                  Online|2024-05-13 13:31:40|4acfa96cb521b6963...|A2d59a13f5f24ae69...| De389f61ac5c8c7ec...|           Blok M|              Online|0a151f113d078794b...|C72ff35974713260b...| Tidak Berhasil|             10|Da0071e2bb7794ac1...|              NULL|                NULL|                NULL|            NULL|2024-05-23 12:32:21|             NULL|                  false|
|               NULL|A95d6a6cefee85033...|Draft Transaction|                 Offline|2024-05-21 16:47:11|Ac7437a85f72bcef2...|3bc4f73ee40575f76...| 488b1d38c3a3d84ab...|      Sunset Road|Aeed83f1695c48689...|Aeed83f1695c48689...|7e5a9e249a06af8dc...|       Berhasil|             10|0ad3f929bef2f8177...|              Paid|2024-05-21 16:47:...|        Adityawarman|             New|2024-05-21 16:49:45|             NULL|                  false|
|               NULL|D452feec722a5cabc...|             Lead|                  Online|2024-03-20 14:48:49|Cbac8ed440d53d1c6...|                NULL|                 NULL|             NULL|              Online|360701f01f7836349...|Ce52ad7070f305b43...|       Menunggu|             10|7709d17eaec03665f...|              NULL|                NULL|                NULL|            NULL|2024-05-01 09:58:57|             NULL|                  false|
|               NULL|9e9324e6fde29bb0d...|Draft Transaction|                 Offline|2024-05-14 13:17:03|F2de40c8394f4ea9a...|2eb4b6e1ee9574c9e...| D02b067e0f767dbb4...|            Pluit|2e68f7f5c8854bd2c...|2e68f7f5c8854bd2c...|321b0102e766ef73b...|       Berhasil|             20|E05121ea99fed4f4c...|              Paid|2024-05-14 13:17:...|        Adityawarman|             New|2024-05-14 13:17:34|             NULL|                  false|
+-------------------+--------------------+-----------------+------------------------+-------------------+--------------------+--------------------+---------------------+-----------------+--------------------+--------------------+--------------------+---------------+---------------+--------------------+------------------+--------------------+--------------------+----------------+-------------------+-----------------+-----------------------+

root
 |-- referral_details_id: integer (nullable = true)
 |-- referral_id: string (nullable = true)
 |-- referral_source: string (nullable = true)
 |-- referral_source_category: string (nullable = true)
 |-- referral_at: timestamp (nullable = true)
 |-- referrer_id: string (nullable = true)
 |-- referrer_name: string (nullable = true)
 |-- referrer_phone_number: string (nullable = true)
 |-- referrer_homeclub: string (nullable = true)
 |-- referee_id: string (nullable = true)
 |-- referee_name: string (nullable = true)
 |-- referee_phone: string (nullable = true)
 |-- referral_status: string (nullable = true)
 |-- num_reward_days: integer (nullable = true)
 |-- transaction_id: string (nullable = true)
 |-- transaction_status: string (nullable = true)
 |-- transaction_at: timestamp (nullable = true)
 |-- transaction_location: string (nullable = true)
 |-- transaction_type: string (nullable = true)
 |-- updated_at: timestamp (nullable = true)
 |-- reward_granted_at: timestamp (nullable = true)
 |-- is_business_logic_valid: boolean (nullable = false)